Connection to 65.108.32.156 closed.
N2T2ks-MacBook-Pro:sh n2t2k$ sh local_stay_login_run_train.sh 
Loading training data ...
duplicates_times >>>  43409
  Documents: 411  
  Words: 22265
  Relations: 12609
	1:AFFILIATION:2	662  	ID: 0
	1:LOCATED:2	461  	ID: 1
	1:NR:2    	10506	ID: 2
	1:PART - WHOLE:2	898  	ID: 3
	1:PERSONAL - SOCIAL:2	82   	ID: 4
  Entities: 4754
	<ENT>     	1    	ID: 0
	<MENT>    	1    	ID: 1
	<SENT>    	1    	ID: 2
	LOCATION  	1998 	ID: 5
	ORGANIZATION	1494 	ID: 3
	PERSON    	1262 	ID: 4
  Singletons: 11787/22265
  Found pre-trained word embeddings: 22533 x 192 --> Words + Pre-trained: 30509
  Preparing TRAIN data - PMID 23366765: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 411/411 [00:00<00:00, 471.74it/s]

Loading testing data ...
duplicates_times >>>  32941
  Documents: 229  
  Words: 13254
  Relations: 8498
	1:AFFILIATION:2	444  	ID: 0
	1:LOCATED:2	324  	ID: 3
	1:NR:2    	7179 	ID: 1
	1:PART - WHOLE:2	462  	ID: 2
	1:PERSONAL - SOCIAL:2	89   	ID: 4
  Entities: 2912
	<ENT>     	1    	ID: 0
	<MENT>    	1    	ID: 1
	<SENT>    	1    	ID: 2
	LOCATION  	1085 	ID: 5
	ORGANIZATION	844  	ID: 3
	PERSON    	983  	ID: 4
  Singletons: 6894/13254
  Preparing TEST data - PMID 23352736: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 229/229 [00:00<00:00, 435.95it/s]

Parameters:
            - Train Data        ../data/VLSP/processed/vlsp_processed_10_05_23_16h_TRAIN_line_411_rm_zero_rel_below_3000_checked_sent
            - Test Data         ../data/VLSP/processed/vlsp_processed_10_05_23_16h_DEV_line_229_rm_zero_rel_below_3000_checked_sent
            - Embeddings        ../embeds/PubMed-VLSP.txt, Freeze: True
            - Save folder       ../results/vlsp-test-new

            - batchsize         2
            - Walks iteration   2 -> Length = 4
            - beta              0.75

            - Context           True
            - Node Type         True
            - Distances         True
            - Edge Types        ['MM', 'ME', 'MS']
            - Window            None
            
            - Epoch             120
            - UNK word prob     0.5
            - Parameter Average True
            - Early stop        False -> Patience = 10
            - Regularization    0.00011
            - Gradient Clip     10
            - Dropout I/O       0.53/0.29
            - Learning rate     0.0037
            - Seed              0
            - lstm_dim          80
            - out_dim           80
            - dist_dim          10
            - type_dim          10
            - bilstm_layers     1
            
            
encoder.enc.weight_ih_l0
encoder.enc.weight_hh_l0
encoder.enc.bias_ih_l0
encoder.enc.bias_hh_l0
encoder.enc.weight_ih_l0_reverse
encoder.enc.weight_hh_l0_reverse
encoder.enc.bias_ih_l0_reverse
encoder.enc.bias_hh_l0_reverse
dist_embed.embedding.weight
type_embed.embedding.weight
reduce.MM.weight
reduce.SS.weight
reduce.ME.weight
reduce.MS.weight
reduce.ES.weight
walk.W
classifier.lin.weight
classifier.lin.bias

======== START TRAINING: 29-05-23_14:39:59 ========

END time_expect: 2023-05-29 15:13:59

/home/edge-oriented-graph-master-studying/src/converter.py:51: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  arrays = numpy.asarray(arrays)
/home/edge-oriented-graph-master-studying/src/nnet/trainer.py:203: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with autograd.detect_anomaly():
/usr/local/lib/python3.8/dist-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/edge-oriented-graph-master-studying/src/nnet/walks.py:39: UserWarning: where received a uint8 condition tensor. This behavior is deprecated and will be removed in a future version of PyTorch. Use a boolean condition instead. (Triggered internally at ../aten/src/ATen/native/TensorCompare.cpp:413.)
  graph = torch.where(adj.unsqueeze(-1), graph, torch.zeros_like(graph))
Epoch: 01 | TRAIN | LOSS = 0.96312, ACC = 0.8274 , MICRO P/R/F1 = 0.0725	0.0026	0.0051 | TP/ACTUAL/PRED = 5      /1901   /69     , TOTAL 11353   | 0h 00m 26s
            TEST  | LOSS = 0.83711, ACC = 0.8435 , MICRO P/R/F1 = 0.0000	0.0000	0.0000 | TP/ACTUAL/PRED = 0      /1147   /0      , TOTAL 7327    | 0h 00m 04s

Epoch: 02 | TRAIN | LOSS = 0.90820, ACC = 0.8319 , MICRO P/R/F1 = 0.2000	0.0011	0.0021 | TP/ACTUAL/PRED = 2      /1901   /10     , TOTAL 11346   | 0h 00m 25s
            TEST  | LOSS = 0.83003, ACC = 0.8435 , MICRO P/R/F1 = 0.0000	0.0000	0.0000 | TP/ACTUAL/PRED = 0      /1147   /0      , TOTAL 7327    | 0h 00m 04s

Epoch: 03 | TRAIN | LOSS = 0.85280, ACC = 0.8316 , MICRO P/R/F1 = 0.0833	0.0005	0.0010 | TP/ACTUAL/PRED = 1      /1901   /12     , TOTAL 11346   | 0h 00m 24s
            TEST  | LOSS = 0.79646, ACC = 0.8435 , MICRO P/R/F1 = 0.0000	0.0000	0.0000 | TP/ACTUAL/PRED = 0      /1147   /0      , TOTAL 7327    | 0h 00m 04s

Epoch: 04 | TRAIN | LOSS = 0.80196, ACC = 0.8306 , MICRO P/R/F1 = 0.2553	0.0063	0.0123 | TP/ACTUAL/PRED = 12     /1901   /47     , TOTAL 11355   | 0h 00m 25s
            TEST  | LOSS = 0.77298, ACC = 0.8435 , MICRO P/R/F1 = 0.0000	0.0000	0.0000 | TP/ACTUAL/PRED = 0      /1147   /0      , TOTAL 7327    | 0h 00m 03s

Epoch: 05 | TRAIN | LOSS = 0.77510, ACC = 0.8256 , MICRO P/R/F1 = 0.2802	0.0268	0.0490 | TP/ACTUAL/PRED = 51     /1901   /182    , TOTAL 11362   | 0h 00m 23s
            TEST  | LOSS = 0.72972, ACC = 0.8435 , MICRO P/R/F1 = 0.0000	0.0000	0.0000 | TP/ACTUAL/PRED = 0      /1147   /0      , TOTAL 7327    | 0h 00m 03s

Epoch: 06 | TRAIN | LOSS = 0.72242, ACC = 0.8209 , MICRO P/R/F1 = 0.2752	0.0431	0.0746 | TP/ACTUAL/PRED = 82     /1901   /298    , TOTAL 11363   | 0h 00m 25s
            TEST  | LOSS = 0.69652, ACC = 0.8435 , MICRO P/R/F1 = 0.0000	0.0000	0.0000 | TP/ACTUAL/PRED = 0      /1147   /0      , TOTAL 7327    | 0h 00m 04s

Epoch: 07 | TRAIN | LOSS = 0.72228, ACC = 0.8194 , MICRO P/R/F1 = 0.3137	0.0673	0.1109 | TP/ACTUAL/PRED = 128    /1901   /408    , TOTAL 11368   | 0h 00m 26s
            TEST  | LOSS = 0.67210, ACC = 0.8435 , MICRO P/R/F1 = 0.0000	0.0000	0.0000 | TP/ACTUAL/PRED = 0      /1147   /0      , TOTAL 7327    | 0h 00m 04s

Epoch: 08 | TRAIN | LOSS = 0.67409, ACC = 0.8231 , MICRO P/R/F1 = 0.3947	0.1105	0.1726 | TP/ACTUAL/PRED = 210    /1901   /532    , TOTAL 11379   | 0h 00m 26s
            TEST  | LOSS = 0.64675, ACC = 0.8435 , MICRO P/R/F1 = 0.0000	0.0000	0.0000 | TP/ACTUAL/PRED = 0      /1147   /0      , TOTAL 7327    | 0h 00m 04s

Epoch: 09 | TRAIN | LOSS = 0.65728, ACC = 0.8263 , MICRO P/R/F1 = 0.4338	0.1310	0.2012 | TP/ACTUAL/PRED = 249    /1901   /574    , TOTAL 11381   | 0h 00m 26s
            TEST  | LOSS = 0.62476, ACC = 0.8444 , MICRO P/R/F1 = 0.8889	0.0070	0.0138 | TP/ACTUAL/PRED = 8      /1147   /9      , TOTAL 7327    | 0h 00m 04s

Epoch: 10 | TRAIN | LOSS = 0.59955, ACC = 0.8271 , MICRO P/R/F1 = 0.4500	0.1610	0.2371 | TP/ACTUAL/PRED = 306    /1901   /680    , TOTAL 11391   | 0h 00m 26s
            TEST  | LOSS = 0.60654, ACC = 0.8447 , MICRO P/R/F1 = 0.8000	0.0105	0.0207 | TP/ACTUAL/PRED = 12     /1147   /15     , TOTAL 7327    | 0h 00m 04s

Epoch: 11 | TRAIN | LOSS = 0.59348, ACC = 0.8414 , MICRO P/R/F1 = 0.5560	0.2430	0.3382 | TP/ACTUAL/PRED = 462    /1901   /831    , TOTAL 11403   | 0h 00m 26s
            TEST  | LOSS = 0.58955, ACC = 0.8450 , MICRO P/R/F1 = 0.6667	0.0192	0.0373 | TP/ACTUAL/PRED = 22     /1147   /33     , TOTAL 7330    | 0h 00m 04s

Epoch: 12 | TRAIN | LOSS = 0.57965, ACC = 0.8365 , MICRO P/R/F1 = 0.5209	0.2430	0.3314 | TP/ACTUAL/PRED = 462    /1901   /887    , TOTAL 11398   | 0h 00m 26s
            TEST  | LOSS = 0.57523, ACC = 0.8452 , MICRO P/R/F1 = 0.6429	0.0235	0.0454 | TP/ACTUAL/PRED = 27     /1147   /42     , TOTAL 7331    | 0h 00m 04s

Epoch: 13 | TRAIN | LOSS = 0.57617, ACC = 0.8370 , MICRO P/R/F1 = 0.5212	0.2588	0.3459 | TP/ACTUAL/PRED = 492    /1901   /944    , TOTAL 11417   | 0h 00m 24s
            TEST  | LOSS = 0.56462, ACC = 0.8460 , MICRO P/R/F1 = 0.6406	0.0357	0.0677 | TP/ACTUAL/PRED = 41     /1147   /64     , TOTAL 7332    | 0h 00m 04s

Epoch: 14 | TRAIN | LOSS = 0.56335, ACC = 0.8402 , MICRO P/R/F1 = 0.5378	0.2883	0.3753 | TP/ACTUAL/PRED = 548    /1901   /1019   , TOTAL 11415   | 0h 00m 26s
            TEST  | LOSS = 0.55585, ACC = 0.8466 , MICRO P/R/F1 = 0.6341	0.0453	0.0846 | TP/ACTUAL/PRED = 52     /1147   /82     , TOTAL 7332    | 0h 00m 04s

Epoch: 15 | TRAIN | LOSS = 0.55571, ACC = 0.8407 , MICRO P/R/F1 = 0.5380	0.3088	0.3924 | TP/ACTUAL/PRED = 587    /1901   /1091   , TOTAL 11416   | 0h 00m 27s
            TEST  | LOSS = 0.54958, ACC = 0.8461 , MICRO P/R/F1 = 0.5849	0.0541	0.0990 | TP/ACTUAL/PRED = 62     /1147   /106    , TOTAL 7334    | 0h 00m 04s

Epoch: 16 | TRAIN | LOSS = 0.53040, ACC = 0.8540 , MICRO P/R/F1 = 0.6175	0.3261	0.4269 | TP/ACTUAL/PRED = 620    /1901   /1004   , TOTAL 11402   | 0h 00m 25s
            TEST  | LOSS = 0.54289, ACC = 0.8469 , MICRO P/R/F1 = 0.5909	0.0680	0.1220 | TP/ACTUAL/PRED = 78     /1147   /132    , TOTAL 7334    | 0h 00m 03s

Epoch: 17 | TRAIN | LOSS = 0.48944, ACC = 0.8585 , MICRO P/R/F1 = 0.6254	0.3751	0.4689 | TP/ACTUAL/PRED = 713    /1901   /1140   , TOTAL 11412   | 0h 00m 24s
            TEST  | LOSS = 0.53469, ACC = 0.8492 , MICRO P/R/F1 = 0.6242	0.0898	0.1570 | TP/ACTUAL/PRED = 103    /1147   /165    , TOTAL 7334    | 0h 00m 04s

Epoch: 18 | TRAIN | LOSS = 0.52549, ACC = 0.8509 , MICRO P/R/F1 = 0.5884	0.3482	0.4375 | TP/ACTUAL/PRED = 662    /1901   /1125   , TOTAL 11415   | 0h 00m 26s
            TEST  | LOSS = 0.52928, ACC = 0.8508 , MICRO P/R/F1 = 0.6464	0.1020	0.1762 | TP/ACTUAL/PRED = 117    /1147   /181    , TOTAL 7334    | 0h 00m 04s

Epoch: 19 | TRAIN | LOSS = 0.50752, ACC = 0.8577 , MICRO P/R/F1 = 0.6224	0.3719	0.4656 | TP/ACTUAL/PRED = 707    /1901   /1136   , TOTAL 11408   | 0h 00m 26s
            TEST  | LOSS = 0.52557, ACC = 0.8518 , MICRO P/R/F1 = 0.6531	0.1116	0.1906 | TP/ACTUAL/PRED = 128    /1147   /196    , TOTAL 7335    | 0h 00m 04s

Epoch: 20 | TRAIN | LOSS = 0.51068, ACC = 0.8597 , MICRO P/R/F1 = 0.6261	0.3919	0.4820 | TP/ACTUAL/PRED = 745    /1901   /1190   , TOTAL 11410   | 0h 00m 24s
            TEST  | LOSS = 0.51982, ACC = 0.8540 , MICRO P/R/F1 = 0.6638	0.1343	0.2234 | TP/ACTUAL/PRED = 154    /1147   /232    , TOTAL 7336    | 0h 00m 03s

Epoch: 21 | TRAIN | LOSS = 0.48282, ACC = 0.8615 , MICRO P/R/F1 = 0.6279	0.4145	0.4994 | TP/ACTUAL/PRED = 788    /1901   /1255   , TOTAL 11404   | 0h 00m 24s
            TEST  | LOSS = 0.51583, ACC = 0.8537 , MICRO P/R/F1 = 0.6457	0.1430	0.2341 | TP/ACTUAL/PRED = 164    /1147   /254    , TOTAL 7336    | 0h 00m 04s

Epoch: 22 | TRAIN | LOSS = 0.49862, ACC = 0.8608 , MICRO P/R/F1 = 0.6249	0.4119	0.4965 | TP/ACTUAL/PRED = 783    /1901   /1253   , TOTAL 11412   | 0h 00m 26s
            TEST  | LOSS = 0.51241, ACC = 0.8555 , MICRO P/R/F1 = 0.6516	0.1630	0.2608 | TP/ACTUAL/PRED = 187    /1147   /287    , TOTAL 7338    | 0h 00m 04s

Epoch: 23 | TRAIN | LOSS = 0.48186, ACC = 0.8661 , MICRO P/R/F1 = 0.6410	0.4471	0.5268 | TP/ACTUAL/PRED = 850    /1901   /1326   , TOTAL 11407   | 0h 00m 26s
            TEST  | LOSS = 0.50979, ACC = 0.8592 , MICRO P/R/F1 = 0.6759	0.1909	0.2978 | TP/ACTUAL/PRED = 219    /1147   /324    , TOTAL 7339    | 0h 00m 04s

Epoch: 24 | TRAIN | LOSS = 0.46745, ACC = 0.8651 , MICRO P/R/F1 = 0.6388	0.4382	0.5198 | TP/ACTUAL/PRED = 833    /1901   /1304   , TOTAL 11410   | 0h 00m 26s
            TEST  | LOSS = 0.50843, ACC = 0.8620 , MICRO P/R/F1 = 0.6801	0.2206	0.3331 | TP/ACTUAL/PRED = 253    /1147   /372    , TOTAL 7340    | 0h 00m 04s

Epoch: 25 | TRAIN | LOSS = 0.45690, ACC = 0.8702 , MICRO P/R/F1 = 0.6554	0.4671	0.5455 | TP/ACTUAL/PRED = 888    /1901   /1355   , TOTAL 11403   | 0h 00m 25s
            TEST  | LOSS = 0.50644, ACC = 0.8645 , MICRO P/R/F1 = 0.6872	0.2432	0.3593 | TP/ACTUAL/PRED = 279    /1147   /406    , TOTAL 7341    | 0h 00m 04s

Epoch: 26 | TRAIN | LOSS = 0.46487, ACC = 0.8685 , MICRO P/R/F1 = 0.6536	0.4487	0.5321 | TP/ACTUAL/PRED = 853    /1901   /1305   , TOTAL 11408   | 0h 00m 25s
            TEST  | LOSS = 0.50496, ACC = 0.8671 , MICRO P/R/F1 = 0.6930	0.2677	0.3862 | TP/ACTUAL/PRED = 307    /1147   /443    , TOTAL 7342    | 0h 00m 04s

Epoch: 27 | TRAIN | LOSS = 0.44033, ACC = 0.8732 , MICRO P/R/F1 = 0.6741	0.4634	0.5493 | TP/ACTUAL/PRED = 881    /1901   /1307   , TOTAL 11406   | 0h 00m 25s
            TEST  | LOSS = 0.50394, ACC = 0.8679 , MICRO P/R/F1 = 0.6920	0.2781	0.3968 | TP/ACTUAL/PRED = 319    /1147   /461    , TOTAL 7342    | 0h 00m 04s

Epoch: 28 | TRAIN | LOSS = 0.43577, ACC = 0.8716 , MICRO P/R/F1 = 0.6522	0.4892	0.5591 | TP/ACTUAL/PRED = 930    /1901   /1426   , TOTAL 11425   | 0h 00m 26s
            TEST  | LOSS = 0.50446, ACC = 0.8697 , MICRO P/R/F1 = 0.6885	0.3025	0.4204 | TP/ACTUAL/PRED = 347    /1147   /504    , TOTAL 7342    | 0h 00m 04s

Epoch: 29 | TRAIN | LOSS = 0.44244, ACC = 0.8718 , MICRO P/R/F1 = 0.6516	0.4940	0.5619 | TP/ACTUAL/PRED = 939    /1901   /1441   , TOTAL 11422   | 0h 00m 25s
            TEST  | LOSS = 0.50491, ACC = 0.8716 , MICRO P/R/F1 = 0.6932	0.3191	0.4370 | TP/ACTUAL/PRED = 366    /1147   /528    , TOTAL 7343    | 0h 00m 04s

Epoch: 30 | TRAIN | LOSS = 0.44708, ACC = 0.8703 , MICRO P/R/F1 = 0.6529	0.4729	0.5485 | TP/ACTUAL/PRED = 899    /1901   /1377   , TOTAL 11410   | 0h 00m 25s
            TEST  | LOSS = 0.50436, ACC = 0.8717 , MICRO P/R/F1 = 0.6860	0.3296	0.4452 | TP/ACTUAL/PRED = 378    /1147   /551    , TOTAL 7343    | 0h 00m 04s

Epoch: 31 | TRAIN | LOSS = 0.41075, ACC = 0.8795 , MICRO P/R/F1 = 0.6787	0.5234	0.5910 | TP/ACTUAL/PRED = 995    /1901   /1466   , TOTAL 11431   | 0h 00m 25s
            TEST  | LOSS = 0.50368, ACC = 0.8739 , MICRO P/R/F1 = 0.6863	0.3548	0.4678 | TP/ACTUAL/PRED = 407    /1147   /593    , TOTAL 7346    | 0h 00m 04s

Epoch: 32 | TRAIN | LOSS = 0.41274, ACC = 0.8772 , MICRO P/R/F1 = 0.6664	0.5245	0.5870 | TP/ACTUAL/PRED = 997    /1901   /1496   , TOTAL 11423   | 0h 00m 26s
            TEST  | LOSS = 0.50281, ACC = 0.8748 , MICRO P/R/F1 = 0.6852	0.3662	0.4773 | TP/ACTUAL/PRED = 420    /1147   /613    , TOTAL 7348    | 0h 00m 04s

Connection to 65.108.32.156 closed by remote host.
Connection to 65.108.32.156 closed.
N2T2ks-MacBook-Pro:sh n2t2k$ 
